(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-45d85630"],{"00ee":function(e,t,s){var o=s("b622"),i=o("toStringTag"),c={};c[i]="z",e.exports="[object z]"===String(c)},"0648":function(e,t,s){},"19aa":function(e,t,s){var o=s("3a9b"),i=TypeError;e.exports=function(e,t){if(o(t,e))return e;throw i("Incorrect invocation")}},"3bbe":function(e,t,s){var o=s("1626"),i=String,c=TypeError;e.exports=function(e){if("object"==typeof e||o(e))return e;throw c("Can't set "+i(e)+" as a prototype")}},"577e":function(e,t,s){var o=s("f5df"),i=String;e.exports=function(e){if("Symbol"===o(e))throw TypeError("Cannot convert a Symbol value to a string");return i(e)}},7156:function(e,t,s){var o=s("1626"),i=s("861d"),c=s("d2bb");e.exports=function(e,t,s){var r,n;return c&&o(r=t.constructor)&&r!==s&&i(n=r.prototype)&&n!==s.prototype&&c(e,n),e}},"78fd":function(e,t,s){"use strict";s.r(t);var o=s("7a23");const i={id:"page-content-wrapper"},c={class:"container-fluid text-start"},r={class:"fs-5 my-2"},n={key:0},a=Object(o["i"])("i",{class:"fas fa-spinner fa-spin fs-1 mt-3"},null,-1),d=[a],l={key:1},u={class:"fs-6 mb-2"},b={class:"row"},h={class:"col-12 col-sm-8 col-md-8"},O={id:"videoFrame"},m=["innerHTML"],p={key:1,class:"r1_iframe_embed border border-secondary rounded"},f=["src"],j={class:"card my-2"},v=Object(o["i"])("div",{class:"card-header fs-6"},"دریافت جزوه",-1),_={key:0,class:"card-body d-flex justify-content-start"},E={key:1,class:"card-body d-flex justify-content-start"},y=["href"],S=Object(o["i"])("i",{class:"fas fa-download"},null,-1),R={class:"col-12 col-sm-4 col-md-4"},g={key:0,class:"card"},I=Object(o["i"])("div",{class:"card-header fs-5 text-center"}," کلیه جلسات این محصول ",-1),T={key:1,class:"card border"},k=Object(o["i"])("div",{class:"card-header"},"چتها",-1),A={key:0,class:"card-body hs-chat-box"},D={key:1,class:"card-body hs-chat-box",id:"hs-chat-box"},C={class:"fw-bold"},x={class:"card-footer row g-0"},w={class:"col-9 col-sm-8 m-0 ps-sm-1 py-1 py-md-0"},M={class:"col-3 col-sm-4 m-0 my-1 my-sm-0"};function N(e,t,s,a,N,L){const V=Object(o["G"])("TheSidemenu"),P=Object(o["G"])("TheTopmenu"),$=Object(o["G"])("VideoSessions");return Object(o["y"])(),Object(o["h"])("div",{class:Object(o["s"])(["d-flex",this.$store.state.menuToggle]),id:"wrapper"},[Object(o["l"])(V),Object(o["i"])("div",i,[Object(o["l"])(P),Object(o["i"])("div",c,[Object(o["i"])("p",r,Object(o["J"])(this.$route.meta.title),1),N.videoSessionData&&0==N.videoSessionData.is_hidden?(Object(o["y"])(),Object(o["h"])("div",l,[Object(o["i"])("div",u,Object(o["J"])(N.videoSessionData.product.name)+" جلسه: "+Object(o["J"])(this.$route.params.videoSessionName),1),Object(o["i"])("div",b,[Object(o["i"])("div",h,[Object(o["i"])("div",O,[N.videoSessionData.video_session.is_aparat?(Object(o["y"])(),Object(o["h"])("div",{key:0,innerHTML:L.decode(N.videoSessionData.video_session.video_link)},null,8,m)):(Object(o["y"])(),Object(o["h"])("div",p,[Object(o["i"])("iframe",{src:L.decode(N.videoSessionData.video_session.video_link),frameborder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:"true",webkitallowfullscreen:"true",mozallowfullscreen:"true"},null,8,f)]))]),Object(o["i"])("div",j,[v,N.videoSessionData.files?(Object(o["y"])(),Object(o["h"])("div",E,[(Object(o["y"])(!0),Object(o["h"])(o["a"],null,Object(o["E"])(N.videoSessionData.files,t=>(Object(o["y"])(),Object(o["h"])("div",{key:t.id,class:"border d-flex justify-content-between m-1 p-2 rounded-1 fs-6"},[Object(o["i"])("a",{href:e.API_STORAGE_URL+t.file_path,target:"_blank"},[S,Object(o["k"])(" "+Object(o["J"])(t.name),1)],8,y)]))),128))])):(Object(o["y"])(),Object(o["h"])("div",_," این جلسه جزوه ندارد "))])]),Object(o["i"])("div",R,["offline"==N.videoSessionData.video_session.video_session_type?(Object(o["y"])(),Object(o["h"])("div",g,[I,Object(o["l"])($,{productId:Number(N.videoSessionData.product.id)},null,8,["productId"])])):(Object(o["y"])(),Object(o["h"])("div",T,[k,N.chatMessages?(Object(o["y"])(),Object(o["h"])("div",D,[(Object(o["y"])(!0),Object(o["h"])(o["a"],null,Object(o["E"])(N.chatMessages,(e,t)=>(Object(o["y"])(),Object(o["h"])("div",{key:t,class:Object(o["s"])("text-start p-2 rounded border mb-1 "+(e.id==this.$store.state.user_id?"text-primary":""))},[Object(o["i"])("span",C,Object(o["J"])(e.name)+": ",1),Object(o["i"])("span",null,Object(o["J"])(e.msg),1)],2))),128))])):(Object(o["y"])(),Object(o["h"])("div",A," پیامی ارسال نشده است ")),Object(o["i"])("div",x,[Object(o["i"])("div",w,[Object(o["S"])(Object(o["i"])("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>N.chatMsg=e),class:"form-control w-100",placeholder:"پیام خود را بنویسید ...",onKeyup:t[1]||(t[1]=Object(o["T"])((...e)=>L.sendChat&&L.sendChat(...e),["enter"]))},null,544),[[o["O"],N.chatMsg]])]),Object(o["i"])("div",M,[Object(o["i"])("a",{onClick:t[2]||(t[2]=(...e)=>L.sendChat&&L.sendChat(...e)),class:"btn btn-success w-100"}," ارسال ")])])]))])])])):(Object(o["y"])(),Object(o["h"])("div",n,d))])])],2)}s("b7ef");var L=s("6bf9"),V=s("75d2"),P=s("09bb"),$=s("90fe"),U=s("c6ca"),H={name:"VideoSessionPlay",created(){this.arefApi=new P["a"](this),this.utils=new $["a"],this.productDetailViedosId=this.$route.params.productDetailViedosId,this.API_STORAGE_URL="https://edu.setavin.com/",this.$store.commit("set",["menuToggle",""]),this.getVideoSessionInfo(),this.tryReconnectSocket(),this.checkStatusLoop()},components:{TheSidemenu:L["a"],TheTopmenu:V["a"],VideoSessions:U["a"]},data(){return{videoSessionData:null,chatMessages:[],chatMsg:null,timerHandler:null,timerIntervalHandle:null,presentationCount:0,videoSessionId:null,isSocketConnected:this.$store.state.socket.isConnected,statusCheckTimer:null}},methods:{getVideoSessionInfo(e=!1){this.arefApi.getUserProductVideoSessionInfo(this.productDetailViedosId).then(t=>{this.videoSessionData=t.data,this.videoSessionId=this.videoSessionData.video_session.id,e||("online"!=this.videoSessionData.video_session.ws&&"online"!=this.videoSessionData.video_session.video_session_type||(this.startChat(),this.onMessage()),this.sendPresentation())}).catch(e=>{console.log(e)})},decode(e){return atob(e)},startChat(){const e={Type:"START_MESSAGE",Token:this.$store.state.token,Data:{video_session_id:Number(this.videoSessionId)}};this.$socket.sendObj(e)},onMessage(){this.$options.sockets.onmessage=e=>{const t=JSON.parse(e.data);"MESSAGE"==t.Type&&(this.chatMessages=this.chatMessages.concat(t.Data))}},sendChat(){if(!this.chatMsg)return;if(this.hasRestrictedWord(this.chatMsg))return void(this.chatMsg="");const e={Type:"MESSAGE",Token:this.$store.state.token,Data:{msg:this.chatMsg,video_session_id:Number(this.videoSessionId)}};this.$socket.sendObj(e),this.chatMsg=null},sendPresentation(){if("VideoSessionPlay"!=this.$route.name)return;const e=0==this.presentationCount?"FIRST_PRESENCE":"PRESENCE";this.presentationCount++;const t={Type:e,Token:this.$store.state.token,Data:{videoSessionId:Number(this.videoSessionId),type:this.videoSessionData.video_session.video_session_type,users_id:this.$store.state.user_id}};this.$store.state.socket.isConnected&&this.$socket.sendObj(t),this.timerHandler=setTimeout(this.sendPresentation,12e4)},tryReconnectSocket(){this.timerIntervalHandle=setInterval(()=>{!this.$store.state.socket.isConnected&&this.$store.state.socket.reconnectError&&this.$connect()},1e4)},hasRestrictedWord(e){const t=["کیر","کون","کثافت","کصافت","کسافت","کص","خامنه ای","خمینی","گاییدن","جاکش","کسکش","سکس","دیوص","دیوس","دیوث","آشغال","عوضی","مادر ننه","بی پدر","بی مادر","صکص","پشمام","خوار","کسده","گوز","خیار","پشم"];for(let s in t)if(e.indexOf(t[s])>=0)return!0;return!1},checkStatusLoop(){this.statusCheckTimer=setInterval(()=>{this.getVideoSessionInfo(!0)},6e4)}},mounted(){this.presentationCount=0},updated(){const e=document.querySelector("#hs-chat-box");e&&e.scrollTo(0,e.scrollHeight)},unmounted(){this.timerIntervalHandle&&clearInterval(this.timerIntervalHandle),this.timerHandler&&clearTimeout(this.timerHandler),this.statusCheckTimer&&clearInterval(this.statusCheckTimer)}},J=(s("85d1"),s("6b0d")),G=s.n(J);const Y=G()(H,[["render",N]]);t["default"]=Y},"85d1":function(e,t,s){"use strict";s("0648")},b7ef:function(e,t,s){"use strict";var o=s("23e7"),i=s("da84"),c=s("d066"),r=s("5c6c"),n=s("9bf2").f,a=s("1a2d"),d=s("19aa"),l=s("7156"),u=s("e391"),b=s("cf98"),h=s("c770"),O=s("83ab"),m=s("c430"),p="DOMException",f=c("Error"),j=c(p),v=function(){d(this,_);var e=arguments.length,t=u(e<1?void 0:arguments[0]),s=u(e<2?void 0:arguments[1],"Error"),o=new j(t,s),i=f(t);return i.name=p,n(o,"stack",r(1,h(i.stack,1))),l(o,this,v),o},_=v.prototype=j.prototype,E="stack"in f(p),y="stack"in new j(1,2),S=j&&O&&Object.getOwnPropertyDescriptor(i,p),R=!!S&&!(S.writable&&S.configurable),g=E&&!R&&!y;o({global:!0,constructor:!0,forced:m||g},{DOMException:g?v:j});var I=c(p),T=I.prototype;if(T.constructor!==I)for(var k in m||n(T,"constructor",r(1,I)),b)if(a(b,k)){var A=b[k],D=A.s;a(I,D)||n(I,D,r(6,A.c))}},c6ca:function(e,t,s){"use strict";var o=s("7a23");const i={key:0,class:"row align-items-center d-flex row"},c={class:"col-xl-2 col-lg-2 col-12 mb-4 mb-lg-0 text-center text-xl-right"},r=["src"],n={class:"col-xl-3 col-lg-3 col-12 text-center text-xl-right"},a={class:"fs-5"},d={class:"col-xl-4 col-lg-5 col-12 text-center text-xl-right"},l={class:"course-card-detail"},u={class:"item text-center"},b={class:"text-center"},h=Object(o["k"])(" تاریخ برگزاری: "),O={class:"col-xl-3 col-lg-12 col-12 col-lg-2 text-end text-xl-left"},m=Object(o["i"])("i",{class:"fas fa-gifts me-1"},null,-1),p=Object(o["i"])("span",null,"ورود رایگان",-1),f=Object(o["i"])("i",{class:"fas fa-check me-1"},null,-1),j=Object(o["i"])("span",null,"ورود به کلاس",-1),v=["onClick"],_=Object(o["i"])("i",{class:"fas fa-shopping-cart me-1"},null,-1),E=Object(o["i"])("span",null,"افزودن به سبد خرید",-1),y=["id"],S=["id"];function R(e,t,s,R,g,I){const T=Object(o["G"])("router-link");return Object(o["y"])(!0),Object(o["h"])(o["a"],null,Object(o["E"])(g.videoSessionList,t=>(Object(o["y"])(),Object(o["h"])("div",{key:t.id,class:"border-bottom p-4 p-lg-3 bg-white"},[0==t.is_hidden?(Object(o["y"])(),Object(o["h"])("div",i,[Object(o["i"])("div",c,[Object(o["i"])("img",{class:"w-100",src:g.API_STORAGE_URL+g.product.thumbnail},null,8,r)]),Object(o["i"])("div",n,[Object(o["i"])("div",a," جلسه "+Object(o["J"])(t.name),1),Object(o["i"])("span",null,Object(o["J"])(this.utils.monize(t.price))+" تومان ",1)]),Object(o["i"])("div",d,[Object(o["i"])("div",l,[Object(o["i"])("div",u,[Object(o["i"])("div",b,[h,Object(o["i"])("span",null,Object(o["J"])(e.jmoment(t.start_date).format("jYYYY/jMM/jDD"))+" ,ساعت "+Object(o["J"])(t.start_time)+" الی "+Object(o["J"])(t.end_time),1)])])])]),Object(o["i"])("div",O,[0==t.price?(Object(o["y"])(),Object(o["f"])(T,{key:0,to:{name:"VideoSession",params:{videoSessionId:t.id,productId:s.productId}},class:"btn btn-sm btn-success d-block"},{default:Object(o["R"])(()=>[m,p]),_:2},1032,["to"])):t.buyed_before?(Object(o["y"])(),Object(o["f"])(T,{key:1,class:"btn btn-sm btn-success d-block",to:{name:"VideoSession",params:{videoSessionId:t.id,productId:s.productId}}},{default:Object(o["R"])(()=>[f,j]),_:2},1032,["to"])):(Object(o["y"])(),Object(o["h"])("a",{key:2,onClick:e=>I.addToCart(t.id),class:"btn btn-outline-primary btn-sm d-block"},[_,E,Object(o["i"])("i",{id:"progress-"+t.id,class:"fas fa-spinner fa-spin d-none"},null,8,y),Object(o["i"])("i",{id:"check-"+t.id,class:"fas fa-check d-none"},null,8,S)],8,v))])])):Object(o["g"])("",!0)]))),128)}var g=s("09bb"),I=s("90fe"),T=s("a67b"),k=s.n(T),A={name:"VideoSessions",created(){this.arefApi=new g["a"](this),this.utils=new I["a"],this.jmoment=k.a,this.getProductVideos()},props:{productId:Number},emits:{changeCart:String},components:{},data(){return{videoSessionList:null,product:null,API_STORAGE_URL:"https://edu.setavin.com/",cartAlert:null}},methods:{emitChangeCart(){this.$emit("changeCart",this.cartAlert)},getProductVideos(){this.arefApi.getUserProductVideoSessions(this.productId,1,!0).then(e=>{this.videoSessionList=e.data.product_detail_videos,this.product=e.data.product}).catch(e=>{this.utils.showErrors(this,e)})},addToCart(e){const t={products_id:this.productId,product_details_id:e};document.querySelector("#progress-"+e).classList.remove("d-none"),this.arefApi.addMicroProductToCart(t).then(t=>{document.querySelector("#progress-"+e).classList.add("d-none"),document.querySelector("#check-"+e).classList.remove("d-none"),this.$store.commit("set",["cartCount",this.utils.getCartCount(t.data)]),this.$store.commit("set",["cartAmount",t.data.amount]),window.scrollTo(0,top)}).catch(t=>{t.data.errors.added_before?this.utils.showSuccess(this,"کل محصول قبلا به سبد اضافه شده است"):this.utils.showErrors(this,t),document.querySelector("#progress-"+e).classList.add("d-none")})}}},D=s("6b0d"),C=s.n(D);const x=C()(A,[["render",R]]);t["a"]=x},c770:function(e,t,s){var o=s("e330"),i=Error,c=o("".replace),r=function(e){return String(i(e).stack)}("zxcasd"),n=/\n\s*at [^:]*:[^\n]*/,a=n.test(r);e.exports=function(e,t){if(a&&"string"==typeof e&&!i.prepareStackTrace)while(t--)e=c(e,n,"");return e}},cf98:function(e,t){e.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}},d2bb:function(e,t,s){var o=s("e330"),i=s("825a"),c=s("3bbe");e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,s={};try{e=o(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set),e(s,[]),t=s instanceof Array}catch(r){}return function(s,o){return i(s),c(o),t?e(s,o):s.__proto__=o,s}}():void 0)},e391:function(e,t,s){var o=s("577e");e.exports=function(e,t){return void 0===e?arguments.length<2?"":t:o(e)}},f5df:function(e,t,s){var o=s("00ee"),i=s("1626"),c=s("c6b6"),r=s("b622"),n=r("toStringTag"),a=Object,d="Arguments"==c(function(){return arguments}()),l=function(e,t){try{return e[t]}catch(s){}};e.exports=o?c:function(e){var t,s,o;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(s=l(t=a(e),n))?s:d?c(t):"Object"==(o=c(t))&&i(t.callee)?"Arguments":o}}}]);
//# sourceMappingURL=chunk-45d85630.e14ecf94.js.map