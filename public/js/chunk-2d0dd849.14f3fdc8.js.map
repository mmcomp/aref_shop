{"version":3,"sources":["webpack:///./src/views/AddCoupons.vue","webpack:///./src/views/AddCoupons.vue?0bfa"],"names":["id","class","_createElementVNode","for","_hoisted_29","_createElementBlock","$store","state","menuToggle","_createVNode","_component_TheSidemenu","_component_TheTopmenu","_toDisplayString","$route","meta","title","$data","type","name","placeholder","$event","_hoisted_8","value","selected","_hoisted_11","_hoisted_12","_hoisted_13","sale_expire","_component_DatePicker","expired_at","_hoisted_16","checked","onClick","amount","_hoisted_21","products_id","_Fragment","_renderList","item","key","_hoisted_24","_hoisted_25","_hoisted_27","rows","description","$options","_hoisted_30","setup","DatePicker","created","this","arefApi","ArefApi","jmoment","components","TheSidemenu","TheTopmenu","data","error","showSpin","productsList","formData","params","couponId","methods","validateFrm","fn","format","Number","then","$swal","fire","text","icon","confirmButtonText","$router","push","catch","err","alertText","errors","i","finally","parseInt","getProductsIndex","res","Promise","resolve","reject","getCoupon","resp","product","loadCouponInfo","getProductsList","__exports__","render"],"mappings":"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","file":"js/chunk-2d0dd849.14f3fdc8.js","sourcesContent":["<template>\n  <div class=\"d-flex\" :class=\"this.$store.state.menuToggle\" id=\"wrapper\">\n    <TheSidemenu />\n    <div id=\"page-content-wrapper\">\n      <TheTopmenu />\n      <div class=\"container-fluid text-start\">\n        <p class=\"fs-6 m-2\">\n          {{ this.$route.meta.title }}\n        </p>\n        <div v-if=\"error\" class=\"alert alert-danger\">\n          {{ error }}\n        </div>\n        <form class=\"row\">\n          <div class=\"col-md-4 col-xs-12\">\n            <div class=\"form-floating mb-3\">\n              <input\n                type=\"text\"\n                class=\"form-control\"\n                id=\"name\"\n                name=\"name\"\n                placeholder=\"نام دسته\"\n                v-model=\"formData.name\"\n              />\n              <label for=\"name\">نام *</label>\n            </div>\n          </div>\n\n          <div class=\"col-md-4 col-xs-6\">\n            <div class=\"form-floating mb-3\">\n              <select\n                class=\"form-control\"\n                id=\"type\"\n                name=\"type\"\n                v-model=\"formData.type\"\n              >\n                <option value=\"amount\" :selected=\"formData.type == 'amount'\">\n                  ثابت - تومان\n                </option>\n                <option value=\"percent\" :selected=\"formData.type == 'percent'\">\n                  درصد\n                </option>\n              </select>\n              <label for=\"category_ones_id\">دسته سطح اول *</label>\n            </div>\n          </div>\n\n          <div class=\"col-md-4 col-xs-6\">\n            <label v-show=\"formData.sale_expire\" for=\"name\"> تاریخ انقضا</label>\n            <DatePicker\n              id=\"expired_at\"\n              name=\"expired_at\"\n              v-model=\"formData.expired_at\"\n              v-show=\"formData.expired_at\"\n            />\n            <br />\n            <input\n              type=\"checkbox\"\n              :checked=\"!formData.expired_at\"\n              @click=\"formData.expired_at = !formData.expired_at\"\n            />\n            بدون تاریخ انقضا\n          </div>\n\n          <div class=\"col-md-4 col-xs-12\">\n            <div class=\"form-floating mb-3\">\n              <input\n                type=\"text\"\n                class=\"form-control\"\n                id=\"amount\"\n                name=\"amount\"\n                placeholder=\"مقدار\"\n                v-model=\"formData.amount\"\n              />\n              <label for=\"amount\">مقدار *</label>\n            </div>\n          </div>\n\n          <div class=\"col-md-4 col-xs-12\">\n            <div class=\"form-floating mb-3\">\n              <select\n                class=\"form-control\"\n                id=\"products_id\"\n                name=\"products_id\"\n                v-model=\"formData.products_id\"\n              >\n                <option v-for=\"item in productsList\" :key=\"item.id\" :value=\"item.id\" >\n                  {{ item.name }}\n                </option>\n              </select>\n              <label for=\"products_id\">محصول *</label>\n            </div>\n          </div>\n          <div class=\"col-md-12 col-xs-12\">\n            <label for=\"description\">توضیحات</label>\n            <textarea\n              class=\"form-control\"\n              rows=\"3\"\n              id=\"description\"\n              name=\"description\"\n              v-model=\"formData.description\"\n            ></textarea>\n          </div>\n        </form>\n        <div class=\"mt-2\" >\n          <a class=\"btn btn-primary btn-block\" @click=\"addEditCoupon()\">\n            ثبت\n          </a>\n          <span v-show=\"showSpin\">\n            <i class=\"fas fa-spinner fa-spin mt-3\"></i>\n          </span>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport TheSidemenu from \"../components/TheSidemenu\";\nimport TheTopmenu from \"../components/TheTopmenu\";\nimport ArefApi from \"../libs/api.js\";\nimport DatePicker from \"vue3-persian-datepicker\";\nimport \"vue3-persian-datepicker/dist/datepicker.min.css\";\nimport jmoment from \"moment-jalaali\";\n\nexport default {\n  name: \"AddCoupon\",\n  setup() {\n    return {\n      DatePicker,\n    };\n  },\n  created() {\n    this.arefApi = new ArefApi();\n    this.jmoment = jmoment;\n  },\n  components: {\n    TheSidemenu,\n    TheTopmenu,\n  },\n  data() {\n    return {\n      error: null,\n      showSpin: false,\n      productsList: null,\n      formData: {\n        id: this.$route.params.couponId ? this.$route.params.couponId : null,\n        name: null,\n        description: null,\n        amount: null,\n        type: null,\n        expired_at: null,\n        products_id: null,\n      },\n    };\n  },\n  methods: {\n    async addEditCoupon() {\n      if (!this.validateFrm()) {\n        return;\n      }\n      this.showSpin = true;\n\n      const fn = this.formData.id ? \"editCoupon\" : \"addCoupon\";\n      if (this.formData.expired_at) {\n        this.formData.expired_at = jmoment(\n          this.formData.expired_at,\n          \"jYYYY/jM/jD\"\n        ).format(\"YYYY-M-D\");\n      }\n      this.formData.products_id = Number(this.formData.products_id);\n      this.arefApi[fn](this.formData)\n        .then(() => {\n          this.$swal\n            .fire({\n              title: \"\",\n              text: `ثبت با موفقیت انجام شد`,\n              icon: \"success\",\n              confirmButtonText: \"متوجه شدم\",\n            })\n            .then(() => {\n              if (!this.formData.id) {\n                this.$router.push({ name: \"ListCoupons\" });\n              }\n            });\n        })\n        .catch((err) => {\n          let alertText = \"\";\n          if (err.data.errors) {\n            for (let i in err.data.errors) {\n              alertText += (alertText ? \"\" : \",\") + `${err.data.errors[i]} `;\n            }\n          }\n          this.$swal.fire({\n            title: \"!خطا\",\n            text: `${alertText}`,\n            icon: \"error\",\n            confirmButtonText: \"متوجه شدم\",\n          });\n        })\n        .finally(() => {\n          this.showSpin = false;\n        });\n    },\n    validateFrm: function () {\n      this.error = null;\n      if (!this.formData.name) {\n        this.error = \"نام باید بیشتر از دو حرف باشد\";\n        return false;\n      }\n\n      if (!this.formData.type) {\n        this.error = \"نوع را انتخاب کنید\";\n        return false;\n      }\n\n      if (!this.formData.amount) {\n        this.error = \"مقدار را انتخاب کنید\";\n        return false;\n      }\n\n      if (!this.formData.products_id) {\n        this.error = \"محصول را انتخاب کنید\";\n        return false;\n      }\n\n      if (this.formData.type == 'percent' && parseInt(this.formData.amount)>100) {\n        this.error = \"درصد تخفیف نمیتواند بیشتر از 100 باشد\";\n        return false;\n      }\n\n      return true;\n    },\n    async getProductsList() {\n      this.arefApi.getProductsIndex(1, true).then((res) => {\n        this.productsList = res.data;\n      });\n    },\n    async loadCouponInfo() {\n      return new Promise((resolve, reject) => {\n        this.arefApi\n          .getCoupon(this.formData.id)\n          .then((resp) => {\n            this.formData = resp.data;\n            this.formData.products_id = resp.data.product.id;\n            resolve();\n          })\n          .catch(() => {\n            this.$swal\n              .fire({\n                title: \"خطا!\",\n                text: \"کد تخفیف پیدا نشد \",\n                icon: \"error\",\n              })\n              .then(() => {\n                this.$router.push({ name: \"ListCoupons\" });\n              });\n            reject();  \n          });\n      });\n    },\n  },\n  async mounted() {\n    if (this.formData.id) {\n      await this.loadCouponInfo();\n    }\n    this.getProductsList();\n  },\n};\n</script>\n\n","import { render } from \"./AddCoupons.vue?vue&type=template&id=e165957a\"\nimport script from \"./AddCoupons.vue?vue&type=script&lang=js\"\nexport * from \"./AddCoupons.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/home/hamed/software/setavin-site/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}