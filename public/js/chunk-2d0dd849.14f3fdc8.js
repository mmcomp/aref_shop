(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0dd849"],{8270:function(t,e,a){"use strict";a.r(e);var o=a("7a23");const i={id:"page-content-wrapper"},r={class:"container-fluid text-start"},c={class:"fs-6 m-2"},s={key:0,class:"alert alert-danger"},n={class:"row"},l={class:"col-md-4 col-xs-12"},d={class:"form-floating mb-3"},m=Object(o["i"])("label",{for:"name"},"نام *",-1),p={class:"col-md-4 col-xs-6"},u={class:"form-floating mb-3"},b=["selected"],f=["selected"],h=Object(o["i"])("label",{for:"category_ones_id"},"دسته سطح اول *",-1),j={class:"col-md-4 col-xs-6"},O={for:"name"},D=Object(o["i"])("br",null,null,-1),x=["checked"],y=Object(o["k"])(" بدون تاریخ انقضا "),_={class:"col-md-4 col-xs-12"},v={class:"form-floating mb-3"},w=Object(o["i"])("label",{for:"amount"},"مقدار *",-1),g={class:"col-md-4 col-xs-12"},k={class:"form-floating mb-3"},S=["value"],C=Object(o["i"])("label",{for:"products_id"},"محصول *",-1),P={class:"col-md-12 col-xs-12"},T=Object(o["i"])("label",{for:"description"},"توضیحات",-1),$={class:"mt-2"},V=Object(o["i"])("i",{class:"fas fa-spinner fa-spin mt-3"},null,-1),Y=[V];function L(t,e,a,V,L,I){const U=Object(o["G"])("TheSidemenu"),A=Object(o["G"])("TheTopmenu"),J=Object(o["G"])("DatePicker");return Object(o["y"])(),Object(o["h"])("div",{class:Object(o["s"])(["d-flex",this.$store.state.menuToggle]),id:"wrapper"},[Object(o["l"])(U),Object(o["i"])("div",i,[Object(o["l"])(A),Object(o["i"])("div",r,[Object(o["i"])("p",c,Object(o["J"])(this.$route.meta.title),1),L.error?(Object(o["y"])(),Object(o["h"])("div",s,Object(o["J"])(L.error),1)):Object(o["g"])("",!0),Object(o["i"])("form",n,[Object(o["i"])("div",l,[Object(o["i"])("div",d,[Object(o["S"])(Object(o["i"])("input",{type:"text",class:"form-control",id:"name",name:"name",placeholder:"نام دسته","onUpdate:modelValue":e[0]||(e[0]=t=>L.formData.name=t)},null,512),[[o["O"],L.formData.name]]),m])]),Object(o["i"])("div",p,[Object(o["i"])("div",u,[Object(o["S"])(Object(o["i"])("select",{class:"form-control",id:"type",name:"type","onUpdate:modelValue":e[1]||(e[1]=t=>L.formData.type=t)},[Object(o["i"])("option",{value:"amount",selected:"amount"==L.formData.type}," ثابت - تومان ",8,b),Object(o["i"])("option",{value:"percent",selected:"percent"==L.formData.type}," درصد ",8,f)],512),[[o["N"],L.formData.type]]),h])]),Object(o["i"])("div",j,[Object(o["S"])(Object(o["i"])("label",O," تاریخ انقضا",512),[[o["P"],L.formData.sale_expire]]),Object(o["S"])(Object(o["l"])(J,{id:"expired_at",name:"expired_at",modelValue:L.formData.expired_at,"onUpdate:modelValue":e[2]||(e[2]=t=>L.formData.expired_at=t)},null,8,["modelValue"]),[[o["P"],L.formData.expired_at]]),D,Object(o["i"])("input",{type:"checkbox",checked:!L.formData.expired_at,onClick:e[3]||(e[3]=t=>L.formData.expired_at=!L.formData.expired_at)},null,8,x),y]),Object(o["i"])("div",_,[Object(o["i"])("div",v,[Object(o["S"])(Object(o["i"])("input",{type:"text",class:"form-control",id:"amount",name:"amount",placeholder:"مقدار","onUpdate:modelValue":e[4]||(e[4]=t=>L.formData.amount=t)},null,512),[[o["O"],L.formData.amount]]),w])]),Object(o["i"])("div",g,[Object(o["i"])("div",k,[Object(o["S"])(Object(o["i"])("select",{class:"form-control",id:"products_id",name:"products_id","onUpdate:modelValue":e[5]||(e[5]=t=>L.formData.products_id=t)},[(Object(o["y"])(!0),Object(o["h"])(o["a"],null,Object(o["E"])(L.productsList,t=>(Object(o["y"])(),Object(o["h"])("option",{key:t.id,value:t.id},Object(o["J"])(t.name),9,S))),128))],512),[[o["N"],L.formData.products_id]]),C])]),Object(o["i"])("div",P,[T,Object(o["S"])(Object(o["i"])("textarea",{class:"form-control",rows:"3",id:"description",name:"description","onUpdate:modelValue":e[6]||(e[6]=t=>L.formData.description=t)},null,512),[[o["O"],L.formData.description]])])]),Object(o["i"])("div",$,[Object(o["i"])("a",{class:"btn btn-primary btn-block",onClick:e[7]||(e[7]=t=>I.addEditCoupon())}," ثبت "),Object(o["S"])(Object(o["i"])("span",null,Y,512),[[o["P"],L.showSpin]])])])])],2)}var I=a("6bf9"),U=a("75d2"),A=a("09bb"),J=a("4424"),E=(a("df04"),a("a67b")),G=a.n(E),N={name:"AddCoupon",setup(){return{DatePicker:J["a"]}},created(){this.arefApi=new A["a"],this.jmoment=G.a},components:{TheSidemenu:I["a"],TheTopmenu:U["a"]},data(){return{error:null,showSpin:!1,productsList:null,formData:{id:this.$route.params.couponId?this.$route.params.couponId:null,name:null,description:null,amount:null,type:null,expired_at:null,products_id:null}}},methods:{async addEditCoupon(){if(!this.validateFrm())return;this.showSpin=!0;const t=this.formData.id?"editCoupon":"addCoupon";this.formData.expired_at&&(this.formData.expired_at=G()(this.formData.expired_at,"jYYYY/jM/jD").format("YYYY-M-D")),this.formData.products_id=Number(this.formData.products_id),this.arefApi[t](this.formData).then(()=>{this.$swal.fire({title:"",text:"ثبت با موفقیت انجام شد",icon:"success",confirmButtonText:"متوجه شدم"}).then(()=>{this.formData.id||this.$router.push({name:"ListCoupons"})})}).catch(t=>{let e="";if(t.data.errors)for(let a in t.data.errors)e+=(e?"":",")+t.data.errors[a]+" ";this.$swal.fire({title:"!خطا",text:""+e,icon:"error",confirmButtonText:"متوجه شدم"})}).finally(()=>{this.showSpin=!1})},validateFrm:function(){return this.error=null,this.formData.name?this.formData.type?this.formData.amount?this.formData.products_id?!("percent"==this.formData.type&&parseInt(this.formData.amount)>100)||(this.error="درصد تخفیف نمیتواند بیشتر از 100 باشد",!1):(this.error="محصول را انتخاب کنید",!1):(this.error="مقدار را انتخاب کنید",!1):(this.error="نوع را انتخاب کنید",!1):(this.error="نام باید بیشتر از دو حرف باشد",!1)},async getProductsList(){this.arefApi.getProductsIndex(1,!0).then(t=>{this.productsList=t.data})},async loadCouponInfo(){return new Promise((t,e)=>{this.arefApi.getCoupon(this.formData.id).then(e=>{this.formData=e.data,this.formData.products_id=e.data.product.id,t()}).catch(()=>{this.$swal.fire({title:"خطا!",text:"کد تخفیف پیدا نشد ",icon:"error"}).then(()=>{this.$router.push({name:"ListCoupons"})}),e()})})}},async mounted(){this.formData.id&&await this.loadCouponInfo(),this.getProductsList()}},B=a("6b0d"),F=a.n(B);const M=F()(N,[["render",L]]);e["default"]=M}}]);
//# sourceMappingURL=chunk-2d0dd849.14f3fdc8.js.map